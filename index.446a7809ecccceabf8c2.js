(()=>{"use strict";var t=document.querySelector(".profile__add"),e=document.querySelector(".profile__edit"),n=document.querySelector(".profile__edit-avatar");function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._config=e,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._submitButton=this._formElement.querySelector(this._config.submitButtonSelector)}var e,n;return e=t,(n=[{key:"_toggleButtonState",value:function(){this._submitButton&&(this._hasInvalidInput()?(this._submitButton.classList.add(this._config.inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._config.inactiveButtonClass),this._submitButton.disabled=!1))}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(t){return!t.validity.valid}))}},{key:"_showInputError",value:function(t,e){this._formElement.querySelector(".".concat(t.id,"-error")).textContent=e,t.classList.add(this._config.inputErrorClass)}},{key:"_hideInputError",value:function(t){this._formElement.querySelector(".".concat(t.id,"-error")).textContent="",t.classList.remove(this._config.inputErrorClass)}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}},{key:"_setEventListeners",value:function(){var t=this;this._toggleButtonState(),this._formElement.addEventListener("reset",(function(){setTimeout((function(){t._toggleButtonState()}),0)})),this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"resetValidation",value:function(){var t=this;this._toggleButtonState(),this._inputList.forEach((function(e){t._checkInputValidity(e)}))}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===u(o)?o:String(o)),r)}var o}var c=function(){function t(e,n,r,o,i,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userId=o,this._name=e.name,this._link=e.link,this._likes=e.likes,this._cardOwnerId=e.owner._id,this._cardId=e._id,this._templateSelector=n,this._handleCardClick=r,this._element=this._getTemplate(),this._favoriteButton=this._element.querySelector(".gallery__favorite"),this._buttonDelete=this._element.querySelector(".gallery__delete-button"),this._galleryImage=this._element.querySelector(".gallery__image"),this._galleryCity=this._element.querySelector(".gallery__city"),this._likesCounter=this._element.querySelector(".gallery__like"),this._handleRemoveCardClick=i,this._handleFavoriteClick=u}var e,n;return e=t,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".gallery__item").cloneNode(!0)}},{key:"generateCard",value:function(){var t=this;return this._galleryCity.textContent=this._name,this._galleryImage.alt=this._name,this._galleryImage.src=this._link,this._likesCounter.textContent=this._likes.length,this._userId!==this._cardOwnerId&&this._buttonDelete.remove(),this._likes.find((function(e){return t._userId===e._id}))&&this._favoriteButton.classList.add("gallery__favorite_active"),this._setEventListeners(),this._element}},{key:"_setEventListeners",value:function(){var t=this;this._favoriteButton.addEventListener("click",(function(){t._handleFavoriteClick(t._cardId,t._favoriteButton.classList.contains("gallery__favorite_active")).then((function(e){t._likes=e.likes,t._likesCounter.textContent=t._likes.length,t._favoriteButton.classList.toggle("gallery__favorite_active")})).catch((function(t){console.log(t)}))})),this._buttonDelete.addEventListener("click",(function(e){t._handleRemoveCardClick((function(){return t._removeCard()}),t._cardId)})),this._galleryImage.addEventListener("click",(function(e){t._handleCardClick(t._name,t._link)}))}},{key:"_removeCard",value:function(){this._element.remove(),this._element=null}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function f(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===l(e)?e:String(e)}var p=function(){function t(e){var n,r,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=function(t){"Escape"===t.key&&i.close()},(r=f(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popupElement=document.querySelector(e)}var e,n;return e=t,(n=[{key:"open",value:function(){document.addEventListener("keydown",this._handleEscClose),this._popupElement.classList.add("popup_opened")}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var t=this;this._popupElement.addEventListener("mousedown",(function(e){(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&t.close()}))}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},h.apply(this,arguments)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(r);if(o){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._popupImage=e._popupElement.querySelector(".popup__image"),e._popupTitle=e._popupElement.querySelector(".popup__photo-name"),e}return e=u,(n=[{key:"open",value:function(t,e){h(d(u.prototype),"open",this).call(this),this._popupImage.src=e,this._popupImage.alt=t,this._popupTitle.textContent=t}}])&&m(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j(r.key),r)}}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},E.apply(this,arguments)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}function j(t){var e=function(t,e){if("object"!==_(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===_(e)?e:String(e)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(r);if(o){var n=k(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}(this,t)});function u(t,e){var n,r,o,a,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),o=w(r=i.call(this,t)),c=function(){E((n=w(r),k(u.prototype)),"setEventListeners",n).call(n),r._form.addEventListener("submit",(function(t){t.preventDefault();var e=r._getInputValues();r._handleFormSubmit(t,e)}))},(a=j(a="setEventListeners"))in o?Object.defineProperty(o,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[a]=c,r._handleFormSubmit=e,r._form=r._popupElement.querySelector("form"),r._inputElements=r._popupElement.querySelectorAll("form input"),r._submitButton=r._popupElement.querySelector("button[type='submit']"),r._submitButtonText=r._submitButton.textContent,r}return e=u,n=[{key:"_getInputValues",value:function(){var t=Array.from(this._inputElements),e={};return t.forEach((function(t){e[t.name]=t.value})),e}},{key:"setInputValues",value:function(t){this._inputElements.forEach((function(e){e.value=t[e.name]}))}},{key:"close",value:function(){E(k(u.prototype),"close",this).call(this),this._form.reset()}},{key:"renderLoading",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Сохранение...";this._submitButton.textContent=t?e:this._submitButtonText}}],n&&g(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==P(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===P(o)?o:String(o)),r)}var o}var I=function(){function t(e){var n=e.userName,r=e.userInfo,o=e.userAvatar;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userNameElement=document.querySelector(n),this._userInfoElement=document.querySelector(r),this._userAvatarElement=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{userName:this._userNameElement.textContent,userInfo:this._userInfoElement.textContent,userId:this._userId}}},{key:"setUserInfo",value:function(t){var e=t.name,n=t.about,r=t._id,o=t.avatar;this._userNameElement.textContent=e,this._userInfoElement.textContent=n,this._userId=r,this._userAvatarElement.src=o}}])&&C(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==L(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===L(o)?o:String(o)),r)}var o}var q=function(){function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderElements",value:function(){var t=this;this._items.forEach((function(e){t.addItem(e,!1)}))}},{key:"addItem",value:function(t,e){var n=this._renderer(t);e?this._container.prepend(n):this._container.append(n)}}])&&T(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==B(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===B(o)?o:String(o)),r)}var o}var U=function(){function t(e){var n=e.baseUrl,r=e.headers;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=n,this.headers=r}var e,n;return e=t,(n=[{key:"_checkResponse",value:function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}},{key:"_request",value:function(t,e){return fetch(t,e).then(this._checkResponse)}},{key:"getCards",value:function(){return this._request("".concat(this.baseUrl,"/cards"),{headers:this.headers})}},{key:"getUser",value:function(){return this._request("".concat(this.baseUrl,"/users/me"),{headers:this.headers})}},{key:"editProfile",value:function(t){var e=t.name,n=t.about;return this._request("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:n})})}},{key:"addCard",value:function(t){var e=t.name,n=t.link;return this._request("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:n})})}},{key:"deleteCard",value:function(t){return this._request("".concat(this.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this.headers})}},{key:"addLike",value:function(t){return this._request("".concat(this.baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this.headers})}},{key:"removeLike",value:function(t){return this._request("".concat(this.baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this.headers})}},{key:"changeAvatar",value:function(t){return this._request("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})})}}])&&R(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,J(r.key),r)}}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}function N(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},V.apply(this,arguments)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}function J(t){var e=function(t,e){if("object"!==x(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===x(e)?e:String(e)}var H=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=F(r);if(o){var n=F(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return N(t)}(this,t)});function u(t){var e,n,r,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),r=N(n=i.call(this,t)),a=function(){V((e=N(n),F(u.prototype)),"setEventListeners",e).call(e),n._confirmationButton.addEventListener("click",(function(){n._confirm()}))},(o=J(o="setEventListeners"))in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,n._confirmationButton=n._popupElement.querySelector(".popup__save"),n}return e=u,(n=[{key:"open",value:function(t){V(F(u.prototype),"open",this).call(this),this._confirm=t}}])&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var z,$=new U({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-60",headers:{authorization:"8a408fa5-d573-4a4b-999d-ef2dcd8b62ea","Content-Type":"application/json"}}),G=function(t,e){Z.open((function(){$.deleteCard(e).then((function(){t(),Z.close()})).catch((function(t){console.log(t)}))}))},K=function(t,e){return e?$.removeLike(t):$.addLike(t)},Q=function(t){return new c(t,"#gallery-item-template",(function(t,e){return Y.open(t,e)}),et.getUserInfo().userId,G,K).generateCard()},W=new O(".popup_type_add",(function(t,e){W.renderLoading(!0),$.addCard({name:e["input-title"],link:e["input-link"]}).then((function(t){z.addItem(t,!0),W.close()})).catch((function(t){console.log(t)})).finally((function(){W.renderLoading()}))})),X=new O(".popup_type_edit",(function(t,e){X.renderLoading(!0),$.editProfile({name:e["input-name"],about:e["input-job"]}).then((function(t){et.setUserInfo(t),X.close()})).catch((function(t){console.log(t)})).finally((function(){X.renderLoading()}))})),Y=new b(".popup_type_photo"),Z=new H(".popup_type_confirm"),tt=new O(".popup_type_avatar",(function(t,e){tt.renderLoading(!0),$.changeAvatar(e["avatar-link"]).then((function(t){et.setUserInfo(t),tt.close()})).catch((function(t){console.log(t)})).finally((function(){tt.renderLoading()}))})),et=new I({userName:".profile__name",userInfo:".profile__description",userAvatar:".profile__image"});Promise.all([$.getUser(),$.getCards()]).then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];et.setUserInfo(o),(z=new q({items:i,renderer:Q},".gallery")).renderElements()})).catch((function(t){console.log(t)})),[W,X,Y,Z,tt].forEach((function(t){t.setEventListeners()}));var nt,rt={};nt={formSelector:".popup",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"},Array.from(document.querySelectorAll(nt.formSelector)).forEach((function(t){if(t.querySelector("form")){var e=new i(nt,t),n=t.querySelector("form").getAttribute("name");rt[n]=e,e.enableValidation()}})),e.addEventListener("click",(function(){X.open();var t=et.getUserInfo();X.setInputValues({"input-name":t.userName,"input-job":t.userInfo}),rt["profile-form"].resetValidation()})),t.addEventListener("click",(function(){W.open()})),n.addEventListener("click",(function(){tt.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguMzNiZmNmOTMzYmFkYWZkYzRiODMuanMiLCJtYXBwaW5ncyI6Im1CQUFBLElBU01BLEVBQWdCQyxTQUFTQyxjQUFjLGlCQUN2Q0MsRUFBb0JGLFNBQVNDLGNBQWMsa0JBQzNDRSxFQUFtQkgsU0FBU0MsY0FBYyx5QixtcUJDWHpDLElBQU1HLEVBQWEsV0FDeEIsV0FBWUMsRUFBUUMsSSw0RkFBYSxTQUMvQkMsS0FBS0MsUUFBVUgsRUFDZkUsS0FBS0UsYUFBZUgsRUFDcEJDLEtBQUtHLFdBQWFDLE1BQU1DLEtBQUtMLEtBQUtFLGFBQWFJLGlCQUFpQk4sS0FBS0MsUUFBUU0sZ0JBQzdFUCxLQUFLUSxjQUFnQlIsS0FBS0UsYUFBYVIsY0FBY00sS0FBS0MsUUFBUVEscUJBQ3BFLEMsUUFnRUMsTyxFQWhFQSxHLEVBQUEsaUNBRUQsV0FDTVQsS0FBS1EsZ0JBQ0hSLEtBQUtVLG9CQUNQVixLQUFLUSxjQUFjRyxVQUFVQyxJQUFJWixLQUFLQyxRQUFRWSxxQkFDOUNiLEtBQUtRLGNBQWNNLFVBQVcsSUFFOUJkLEtBQUtRLGNBQWNHLFVBQVVJLE9BQU9mLEtBQUtDLFFBQVFZLHFCQUNqRGIsS0FBS1EsY0FBY00sVUFBVyxHQUdwQyxHQUFDLDhCQUVELFdBQ0UsT0FBT2QsS0FBS0csV0FBV2EsTUFBSyxTQUFDQyxHQUMzQixPQUFRQSxFQUFNQyxTQUFTQyxLQUN6QixHQUNGLEdBQUMsNkJBRUQsU0FBZ0JGLEVBQU9HLEdBQ0ZwQixLQUFLRSxhQUFhUixjQUFjLElBQUQsT0FBS3VCLEVBQU1JLEdBQUUsV0FDcERDLFlBQWNGLEVBQ3pCSCxFQUFNTixVQUFVQyxJQUFJWixLQUFLQyxRQUFRc0IsZ0JBQ25DLEdBQUMsNkJBRUQsU0FBZ0JOLEdBQ0tqQixLQUFLRSxhQUFhUixjQUFjLElBQUQsT0FBS3VCLEVBQU1JLEdBQUUsV0FDcERDLFlBQWMsR0FDekJMLEVBQU1OLFVBQVVJLE9BQU9mLEtBQUtDLFFBQVFzQixnQkFDdEMsR0FBQyxpQ0FFRCxTQUFvQk4sR0FDYkEsRUFBTUMsU0FBU0MsTUFHbEJuQixLQUFLd0IsZ0JBQWdCUCxHQUZyQmpCLEtBQUt5QixnQkFBZ0JSLEVBQU9BLEVBQU1TLGtCQUl0QyxHQUFDLGdDQUVELFdBQXFCLFdBQ25CMUIsS0FBSzJCLHFCQUNMM0IsS0FBS0UsYUFBYTBCLGlCQUFpQixTQUFTLFdBQzFDQyxZQUFXLFdBQ1gsRUFBS0Ysb0JBQ0wsR0FBRyxFQUNMLElBQ0EzQixLQUFLRyxXQUFXMkIsU0FBUSxTQUFDYixHQUN2QkEsRUFBTVcsaUJBQWlCLFNBQVMsV0FDOUIsRUFBS0csb0JBQW9CZCxHQUN6QixFQUFLVSxvQkFDUCxHQUNGLEdBQ0YsR0FBQyw4QkFFRCxXQUNFM0IsS0FBS2dDLG9CQUNQLEdBQUMsNkJBRUQsV0FBa0IsV0FDaEJoQyxLQUFLMkIscUJBQ0wzQixLQUFLRyxXQUFXMkIsU0FBUSxTQUFDYixHQUN2QixFQUFLYyxvQkFBb0JkLEVBQzNCLEdBQ0YsTSxvRUFBQyxFQXRFdUIsRyxtcUJDQ25CLElBQU1nQixFQUFJLFdBQ2YsV0FBWUMsRUFBTUMsRUFBa0JDLEVBQWlCQyxFQUFRQyxFQUF1QkMsSSw0RkFBcUIsU0FDdkd2QyxLQUFLd0MsUUFBVUgsRUFDZnJDLEtBQUt5QyxNQUFRUCxFQUFLUSxLQUNsQjFDLEtBQUsyQyxNQUFRVCxFQUFLVSxLQUNsQjVDLEtBQUs2QyxPQUFRWCxFQUFLWSxNQUNsQjlDLEtBQUsrQyxhQUFlYixFQUFLYyxNQUFNQyxJQUMvQmpELEtBQUtrRCxRQUFVaEIsRUFBS2UsSUFDcEJqRCxLQUFLbUQsa0JBQW9CaEIsRUFDekJuQyxLQUFLb0QsaUJBQW1CaEIsRUFDeEJwQyxLQUFLcUQsU0FBV3JELEtBQUtzRCxlQUNyQnRELEtBQUt1RCxnQkFBa0J2RCxLQUFLcUQsU0FBUzNELGNBQWMsc0JBQ25ETSxLQUFLd0QsY0FBZ0J4RCxLQUFLcUQsU0FBUzNELGNBQWMsMkJBQ2pETSxLQUFLeUQsY0FBZ0J6RCxLQUFLcUQsU0FBUzNELGNBQWMsbUJBQ2pETSxLQUFLMEQsYUFBZTFELEtBQUtxRCxTQUFTM0QsY0FBYyxrQkFDaERNLEtBQUsyRCxjQUFnQjNELEtBQUtxRCxTQUFTM0QsY0FBYyxrQkFDakRNLEtBQUs0RCx1QkFBeUJ0QixFQUM5QnRDLEtBQUs2RCxxQkFBdUJ0QixDQUM5QixDLFFBc0RDLE8sRUF0REEsRyxFQUFBLDJCQUVELFdBT0UsT0FOb0I5QyxTQUNqQkMsY0FBY00sS0FBS21ELG1CQUNuQlcsUUFDQXBFLGNBQWMsa0JBQ2RxRSxXQUFVLEVBR2YsR0FBQywwQkFFRCxXQUFlLFdBZWIsT0FkQS9ELEtBQUswRCxhQUFhcEMsWUFBY3RCLEtBQUt5QyxNQUNyQ3pDLEtBQUt5RCxjQUFjTyxJQUFNaEUsS0FBS3lDLE1BQzlCekMsS0FBS3lELGNBQWNRLElBQU1qRSxLQUFLMkMsTUFDOUIzQyxLQUFLMkQsY0FBY3JDLFlBQWN0QixLQUFLNkMsT0FBT3FCLE9BQ3pDbEUsS0FBS3dDLFVBQVl4QyxLQUFLK0MsY0FDeEIvQyxLQUFLd0QsY0FBY3pDLFNBRWpCZixLQUFLNkMsT0FBT3NCLE1BQUssU0FBQ0MsR0FDcEIsT0FBTyxFQUFLNUIsVUFBWTRCLEVBQUtuQixHQUMvQixLQUNFakQsS0FBS3VELGdCQUFnQjVDLFVBQVVDLElBQUksNEJBRXJDWixLQUFLZ0MscUJBRUVoQyxLQUFLcUQsUUFDZCxHQUFDLGdDQUVELFdBQXFCLFdBQ25CckQsS0FBS3VELGdCQUFnQjNCLGlCQUFpQixTQUFTLFdBQzdDLEVBQUtpQyxxQkFBcUIsRUFBS1gsUUFBVSxFQUFLSyxnQkFBZ0I1QyxVQUFVMEQsU0FBUyw2QkFDOUVDLE1BQUssU0FBQ0MsR0FDTCxFQUFLMUIsT0FBUzBCLEVBQUl6QixNQUNsQixFQUFLYSxjQUFjckMsWUFBYyxFQUFLdUIsT0FBT3FCLE9BQzdDLEVBQUtYLGdCQUFnQjVDLFVBQVU2RCxPQUFPLDJCQUN4QyxJQUNDQyxPQUFNLFNBQUNDLEdBQ1JDLFFBQVFDLElBQUlGLEVBQ2QsR0FDRixJQUNBMUUsS0FBS3dELGNBQWM1QixpQkFBaUIsU0FBUyxTQUFDaUQsR0FDNUMsRUFBS2pCLHdCQUF1QixrQkFBTSxFQUFLa0IsYUFBYSxHQUFFLEVBQUs1QixRQUM3RCxJQUVBbEQsS0FBS3lELGNBQWM3QixpQkFBaUIsU0FBUyxTQUFDaUQsR0FDNUMsRUFBS3pCLGlCQUFpQixFQUFLWCxNQUFPLEVBQUtFLE1BQ3pDLEdBQ0YsR0FBQyx5QkFFRCxXQUNFM0MsS0FBS3FELFNBQVN0QyxTQUNkZixLQUFLcUQsU0FBVyxJQUNsQixNLG9FQUFDLEVBeEVjLEcsa3JCQ0RWLElBQU0wQixFQUFLLFdBQ2hCLFdBQVlDLEdBQWUsSSxNQUFBLFEsNEZBQUEsUyxFQUFBLEssRUFjVCxTQUFDQyxHQUNELFdBQVpBLEVBQUlDLEtBQ04sRUFBS0MsT0FFVCxHLE1BbEIyQixzQix3RkFDekJuRixLQUFLb0YsY0FBZ0IzRixTQUFTQyxjQUFjc0YsRUFDOUMsQyxRQTJCQyxPLEVBM0JBLEcsRUFBQSxtQkFFRCxXQUNFdkYsU0FBU21DLGlCQUFpQixVQUFXNUIsS0FBS3FGLGlCQUMxQ3JGLEtBQUtvRixjQUFjekUsVUFBVUMsSUFBSSxlQUNuQyxHQUFDLG1CQUVELFdBQ0VaLEtBQUtvRixjQUFjekUsVUFBVUksT0FBTyxnQkFDcEN0QixTQUFTNkYsb0JBQW9CLFVBQVd0RixLQUFLcUYsZ0JBQy9DLEdBQUMsK0JBUUQsV0FBb0IsV0FDbEJyRixLQUFLb0YsY0FBY3hELGlCQUFpQixhQUFhLFNBQUNxRCxJQUM1Q0EsRUFBSU0sT0FBTzVFLFVBQVUwRCxTQUFTLGlCQUd6QlksRUFBSU0sT0FBTzVFLFVBQVUwRCxTQUFTLGtCQUZyQyxFQUFLYyxPQUtULEdBQ0YsTSxvRUFBQyxFQTlCZSxHLGd2Q0NFWCxJQUFNSyxFQUFjLGEscVJBQUEsVSxRQUFBLEcsRUFBQSxFLHFyQkFDekIsV0FBWVIsR0FBZSxNQUdpRCxPLDRGQUhqRCxVQUN6QixjQUFNQSxJQUNEUyxZQUFjLEVBQUtMLGNBQWMxRixjQUFjLGlCQUNwRCxFQUFLZ0csWUFBYyxFQUFLTixjQUFjMUYsY0FBYyxzQkFBc0IsQ0FDNUUsQ0FPQyxPLEVBUEEsRyxFQUFBLG1CQUVELFNBQUtnRCxFQUFNRSxHQUNULHlDQUNBNUMsS0FBS3lGLFlBQVl4QixJQUFNckIsRUFDdkI1QyxLQUFLeUYsWUFBWXpCLElBQU10QixFQUN2QjFDLEtBQUswRixZQUFZcEUsWUFBY29CLENBQ2pDLE0sb0VBQUMsRUFad0IsQ0FBU3FDLEcsMDNDQ0E3QixJQUFNWSxFQUFhLGEscVJBQUEsVSxRQUFBLEcsRUFBQSxFLDZqQkFDeEIsV0FBWVgsRUFBZVksR0FBa0IsUSxNQU1hLE8sNEZBTmIsUyxFQUN0QixFQUFyQixjQUFNWixJLEVBUVksV0FDbEIseURBQ0EsRUFBS2EsTUFBTWpFLGlCQUFpQixVQUFVLFNBQUNxRCxHQUNyQ0EsRUFBSWEsaUJBQ0osSUFBTUMsRUFBUyxFQUFLQyxrQkFDcEIsRUFBS0Msa0JBQWtCaEIsRUFBS2MsRUFDOUIsR0FDRixHLE1BZnVCLHdCLHdGQUNyQixFQUFLRSxrQkFBb0JMLEVBQ3pCLEVBQUtDLE1BQVEsRUFBS1QsY0FBYzFGLGNBQWMsUUFDOUMsRUFBS3dHLGVBQWlCLEVBQUtkLGNBQWM5RSxpQkFBaUIsY0FDMUQsRUFBS0UsY0FBZ0IsRUFBSzRFLGNBQWMxRixjQUFjLHlCQUN0RCxFQUFLeUcsa0JBQW9CLEVBQUszRixjQUFjYyxZQUFZLENBQzFELENBcUNDLE8sRUFyQ0EsRSxFQUFBLDhCQVdELFdBQ0UsSUFBTThFLEVBQVdoRyxNQUFNQyxLQUFLTCxLQUFLa0csZ0JBQzNCRyxFQUFTLENBQUMsRUFJaEIsT0FIQUQsRUFBU3RFLFNBQVEsU0FBQ3dFLEdBQ2hCRCxFQUFPQyxFQUFRNUQsTUFBUTRELEVBQVFDLEtBQ2pDLElBQ09GLENBQ1QsR0FBQyw0QkFFRCxTQUFlbkUsR0FDYmxDLEtBQUtrRyxlQUFlcEUsU0FBUSxTQUFDYixHQUMzQkEsRUFBTXNGLE1BQVFyRSxFQUFLakIsRUFBTXlCLEtBQzNCLEdBQ0YsR0FBQyxtQkFFRCxXQUNFLDBDQUNBMUMsS0FBSzZGLE1BQU1XLE9BQ2IsR0FBQywyQkFFRCxTQUFjQyxHQUF3QyxJQUE3QkMsRUFBVyx1REFBQyxnQkFFakMxRyxLQUFLUSxjQUFjYyxZQURqQm1GLEVBQytCQyxFQUVBMUcsS0FBS21HLGlCQUUxQyxJLHVFQUFDLEVBN0N1QixDQUFTcEIsRyxtcUJDRjVCLElBQU00QixFQUFRLFdBQ25CLGNBQThDLElBQWpDQyxFQUFRLEVBQVJBLFNBQVVDLEVBQVEsRUFBUkEsU0FBVUMsRUFBVSxFQUFWQSxZLDRGQUFVLFNBQ3pDOUcsS0FBSytHLGlCQUFtQnRILFNBQVNDLGNBQWNrSCxHQUMvQzVHLEtBQUtnSCxpQkFBbUJ2SCxTQUFTQyxjQUFjbUgsR0FDL0M3RyxLQUFLaUgsbUJBQXFCeEgsU0FBU0MsY0FBY29ILEVBQ25ELEMsUUFlQyxPLEVBZkEsRyxFQUFBLDBCQUVELFdBQ0UsTUFBTyxDQUNMRixTQUFVNUcsS0FBSytHLGlCQUFpQnpGLFlBQ2hDdUYsU0FBVTdHLEtBQUtnSCxpQkFBaUIxRixZQUNoQ2UsT0FBUXJDLEtBQUt3QyxRQUVqQixHQUFDLHlCQUVELFlBQXdDLElBQTNCRSxFQUFJLEVBQUpBLEtBQU13RSxFQUFLLEVBQUxBLE1BQU9qRSxFQUFHLEVBQUhBLElBQUtrRSxFQUFNLEVBQU5BLE9BQzdCbkgsS0FBSytHLGlCQUFpQnpGLFlBQWNvQixFQUNwQzFDLEtBQUtnSCxpQkFBaUIxRixZQUFjNEYsRUFDcENsSCxLQUFLd0MsUUFBVVMsRUFDZmpELEtBQUtpSCxtQkFBbUJoRCxJQUFNa0QsQ0FDaEMsTSxvRUFBQyxFQXBCa0IsRyxtcUJDQWQsSUFBTUMsRUFBTyxXQUNsQixhQUErQkMsR0FBbUIsSUFBckNDLEVBQUssRUFBTEEsTUFBT0MsRUFBUSxFQUFSQSxVLDRGQUFRLFNBQzFCdkgsS0FBS3dILE9BQVNGLEVBQ2R0SCxLQUFLeUgsVUFBWUYsRUFDakJ2SCxLQUFLMEgsV0FBYWpJLFNBQVNDLGNBQWMySCxFQUMzQyxDLFFBV0MsTyxFQVhBLEcsRUFBQSw2QkFFRCxXQUFrQixXQUNoQnJILEtBQUt3SCxPQUFPMUYsU0FBUSxTQUFDc0MsR0FDbkIsRUFBS3VELFFBQVF2RCxHQUFNLEVBQ3JCLEdBQ0YsR0FBQyxxQkFFRCxTQUFTQSxFQUFNd0QsR0FDYixJQUFNdEIsRUFBVXRHLEtBQUt5SCxVQUFVckQsR0FDL0J3RCxFQUFVNUgsS0FBSzBILFdBQVdFLFFBQVF0QixHQUFXdEcsS0FBSzBILFdBQVdHLE9BQU92QixFQUN0RSxNLG9FQUFDLEVBaEJpQixHLG1xQkNBYixJQUFNd0IsRUFBRyxXQUNkLGNBQWdDLElBQW5CQyxFQUFPLEVBQVBBLFFBQVNDLEVBQU8sRUFBUEEsUyw0RkFBTyxTQUMzQmhJLEtBQUsrSCxRQUFVQSxFQUNmL0gsS0FBS2dJLFFBQVVBLENBQ2pCLEMsUUFxRUMsTyxFQXJFQSxHLEVBQUEsNkJBRUQsU0FBZXpELEdBQ2IsT0FBSUEsRUFBSTBELEdBQ0MxRCxFQUFJMkQsT0FFTkMsUUFBUUMsT0FBTyxXQUFELE9BQVk3RCxFQUFJOEQsUUFDdkMsR0FBQyxzQkFFRCxTQUFTQyxFQUFLQyxHQUNaLE9BQU9DLE1BQU1GLEVBQUtDLEdBQVNqRSxLQUFLdEUsS0FBS3lJLGVBQ3ZDLEdBQUMsc0JBRUQsV0FDRSxPQUFPekksS0FBSzBJLFNBQVMsR0FBRCxPQUFJMUksS0FBSytILFFBQU8sVUFBVSxDQUM1Q0MsUUFBU2hJLEtBQUtnSSxTQUVsQixHQUFDLHFCQUVELFdBQ0UsT0FBT2hJLEtBQUswSSxTQUFTLEdBQUQsT0FBSTFJLEtBQUsrSCxRQUFPLGFBQWEsQ0FDL0NDLFFBQVNoSSxLQUFLZ0ksU0FFbEIsR0FBQyx5QkFHRCxZQUEyQixJQUFkdEYsRUFBSSxFQUFKQSxLQUFNd0UsRUFBSyxFQUFMQSxNQUNqQixPQUFPbEgsS0FBSzBJLFNBQVMsR0FBRCxPQUFJMUksS0FBSytILFFBQU8sYUFBYSxDQUMvQ1ksT0FBUSxRQUNSWCxRQUFTaEksS0FBS2dJLFFBQ2RZLEtBQU1DLEtBQUtDLFVBQVUsQ0FBQ3BHLEtBQUFBLEVBQU13RSxNQUFBQSxLQUVoQyxHQUFDLHFCQUVELFlBQXNCLElBQWJ4RSxFQUFJLEVBQUpBLEtBQU1FLEVBQUksRUFBSkEsS0FDYixPQUFPNUMsS0FBSzBJLFNBQVMsR0FBRCxPQUFJMUksS0FBSytILFFBQU8sVUFBVSxDQUM1Q1ksT0FBUSxPQUNSWCxRQUFTaEksS0FBS2dJLFFBQ2RZLEtBQU1DLEtBQUtDLFVBQVUsQ0FBQ3BHLEtBQUFBLEVBQU1FLEtBQUFBLEtBRWhDLEdBQUMsd0JBRUQsU0FBV3ZCLEdBQ1QsT0FBT3JCLEtBQUswSSxTQUFTLEdBQUQsT0FBSTFJLEtBQUsrSCxRQUFPLGtCQUFVMUcsR0FBTSxDQUNsRHNILE9BQVEsU0FDUlgsUUFBU2hJLEtBQUtnSSxTQUVsQixHQUFDLHFCQUVELFNBQVEzRyxHQUNOLE9BQU9yQixLQUFLMEksU0FBUyxHQUFELE9BQUkxSSxLQUFLK0gsUUFBTyxrQkFBVTFHLEVBQUUsVUFBVSxDQUN4RHNILE9BQVEsTUFDUlgsUUFBU2hJLEtBQUtnSSxTQUVsQixHQUFDLHdCQUVELFNBQVczRyxHQUNULE9BQU9yQixLQUFLMEksU0FBUyxHQUFELE9BQUkxSSxLQUFLK0gsUUFBTyxrQkFBVTFHLEVBQUUsVUFBVSxDQUN4RHNILE9BQVEsU0FDUlgsUUFBU2hJLEtBQUtnSSxTQUVsQixHQUFDLDBCQUVELFNBQWFiLEdBQ1gsT0FBT25ILEtBQUswSSxTQUFTLEdBQUQsT0FBSTFJLEtBQUsrSCxRQUFPLG9CQUFvQixDQUN0RFksT0FBUSxRQUNSWCxRQUFTaEksS0FBS2dJLFFBQ2RZLEtBQU1DLEtBQUtDLFVBQVUsQ0FBQzNCLE9BQUFBLEtBRTFCLE0sb0VBQUMsRUF6RWEsRywwM0NDRVQsSUFBTTRCLEVBQXFCLGEscVJBQUEsVSxRQUFBLEcsRUFBQSxFLDZqQkFDaEMsV0FBWS9ELEdBQWUsUSxNQUVtRCxPLDRGQUZuRCxTLEVBQ0osRUFBckIsY0FBTUEsSSxFQUlZLFdBQ2xCLHlEQUNBLEVBQUtnRSxvQkFBb0JwSCxpQkFBaUIsU0FBUyxXQUNqRCxFQUFLcUgsVUFDUCxHQUNGLEcsTUFUdUIsd0Isd0ZBQ3JCLEVBQUtELG9CQUFzQixFQUFLNUQsY0FBYzFGLGNBQWMsZ0JBQWdCLENBQzlFLENBWUMsTyxFQVpBLEcsRUFBQSxtQkFTRCxTQUFLd0osR0FDSCx5Q0FDQWxKLEtBQUtpSixTQUFXQyxDQUNsQixNLG9FQUFDLEVBaEIrQixDQUFTbkUsRywwR0NjM0MsSUEwRklvRSxFQTFGRUMsRUFBTSxJQUFJdEIsRUFBSSxDQUNsQkMsUUFBUyw4Q0FDVEMsUUFBUyxDQUNQcUIsY0FBZSx1Q0FDZixlQUFnQixzQkFpRGQvRyxFQUF3QixTQUFDZ0gsRUFBZWpJLEdBQzVDa0ksRUFBa0JDLE1BQUssV0FDckJKLEVBQUlLLFdBQVdwSSxHQUFJaUQsTUFBSyxXQUN0QmdGLElBQ0FDLEVBQWtCcEUsT0FDcEIsSUFDQ1YsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLEdBQ0YsR0FDRixFQUVNbkMsRUFBc0IsU0FBQ2xCLEVBQUlxSSxHQUMvQixPQUFPQSxFQUFVTixFQUFJTyxXQUFXdEksR0FBTStILEVBQUlRLFFBQVF2SSxFQUNwRCxFQUVNd0ksRUFBYSxTQUFDQyxHQVFsQixPQVBhLElBQUk3SCxFQUFLNkgsRUFDcEIsMEJBQ0EsU0FBQ3BILEVBQU1FLEdBQUksT0FBS21ILEVBQVdQLEtBQUs5RyxFQUFNRSxFQUFLLEdBQzNDaUUsR0FBU21ELGNBQWMzSCxPQUN2QkMsRUFDQUMsR0FDdUIwSCxjQUUzQixFQUVNQyxFQUFlLElBQUl2RSxFQUFjLG1CQXhFVixTQUFDVixFQUFLL0MsR0FDakNnSSxFQUFhQyxlQUFjLEdBQzNCZixFQUFJZ0IsUUFBUSxDQUFDMUgsS0FBTVIsRUFBSyxlQUFnQlUsS0FBTVYsRUFBSyxnQkFDaERvQyxNQUNDLFNBQUNDLEdBQ0M0RSxFQUFheEIsUUFBUXBELEdBQUssR0FDMUIyRixFQUFhL0UsT0FDZixJQUNEVixPQUFNLFNBQUNDLEdBQ05DLFFBQVFDLElBQUlGLEVBQ2QsSUFDQzJGLFNBQVEsV0FDUEgsRUFBYUMsZUFDZixHQUNKLElBMkRNRyxFQUFtQixJQUFJM0UsRUFBYyxvQkExRFgsU0FBQ1YsRUFBSy9DLEdBQ3BDb0ksRUFBaUJILGVBQWMsR0FDL0JmLEVBQUltQixZQUFZLENBQUM3SCxLQUFNUixFQUFLLGNBQWVnRixNQUFPaEYsRUFBSyxlQUNwRG9DLE1BQUssU0FBQ0MsR0FDTHNDLEdBQVMyRCxZQUFZakcsR0FDckIrRixFQUFpQm5GLE9BQ25CLElBQ0NWLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsRUFDZCxJQUNDMkYsU0FBUSxXQUNQQyxFQUFpQkgsZUFDbkIsR0FDSixJQThDTUosRUFBYSxJQUFJdkUsRUFBZSxxQkFDaEMrRCxFQUFvQixJQUFJUixFQUFzQix1QkFDOUMwQixHQUFjLElBQUk5RSxFQUFjLHNCQTlDUCxTQUFDVixFQUFLL0MsR0FDbkN1SSxHQUFZTixlQUFjLEdBQzFCZixFQUFJc0IsYUFBYXhJLEVBQUssZ0JBQ25Cb0MsTUFBSyxTQUFDQyxHQUNMc0MsR0FBUzJELFlBQVlqRyxHQUNyQmtHLEdBQVl0RixPQUNkLElBQ0NWLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsRUFDZCxJQUNDMkYsU0FBUSxXQUNQSSxHQUFZTixlQUNkLEdBQ0osSUFrQ010RCxHQUFXLElBQUlGLEVBQVMsQ0FDNUJDLFNBQVUsaUJBQ1ZDLFNBQVUsd0JBQ1ZDLFdBQVksb0JBSWRxQixRQUFRd0MsSUFBSSxDQUFDdkIsRUFBSXdCLFVBQVd4QixFQUFJeUIsYUFDN0J2RyxNQUFLLFlBQW1CLEksSUFBQSxHLEVBQUEsRSw0Q0FBQSxJLG8yQkFBakJ3RyxFQUFJLEtBQUVDLEVBQUssS0FDakJsRSxHQUFTMkQsWUFBWU0sSUFDckIzQixFQUFlLElBQUkvQixFQUFRLENBQUNFLE1BQU95RCxFQUFPeEQsU0FBVXNDLEdBQWEsYUFDcERtQixnQkFDZixJQUNDdkcsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLElBR0YsQ0FBQ3dGLEVBQWNJLEVBQWtCUCxFQUFZUixFQUFtQmtCLElBQWEzSSxTQUFRLFNBQUNzQyxHQUNwRkEsRUFBSzZHLG1CQUNQLElBRUEsSUFFMEJuTCxHQUZwQm9MLEdBQWlCLENBQUMsRUFFRXBMLEdWN0hELENBQ3ZCcUwsYUFBYyxTQUNkNUssY0FBZSxnQkFDZkUscUJBQXNCLGVBQ3RCSSxvQkFBcUIsdUJBQ3JCVSxnQkFBaUIsMEJBQ2pCNkosV0FBWSw4QlV3SE1oTCxNQUFNQyxLQUFLWixTQUFTYSxpQkFBaUJSLEdBQU9xTCxlQUNwRHJKLFNBQVEsU0FBQy9CLEdBQ2pCLEdBQUlBLEVBQVlMLGNBQWMsUUFBUyxDQUNyQyxJQUFNMkwsRUFBWSxJQUFJeEwsRUFBY0MsR0FBUUMsR0FDdEN1TCxFQUFXdkwsRUFBWUwsY0FBYyxRQUFRNkwsYUFBYSxRQUNoRUwsR0FBZUksR0FBWUQsRUFDM0JBLEVBQVVHLGtCQUNaLENBQ0YsSUFLRjdMLEVBQWtCaUMsaUJBQWlCLFNBQVMsV0FDMUMwSSxFQUFpQmQsT0FDakIsSUFBTWlDLEVBQVc1RSxHQUFTbUQsY0FDMUJNLEVBQWlCb0IsZUFBZSxDQUM5QixhQUFjRCxFQUFTN0UsU0FDdkIsWUFBYTZFLEVBQVM1RSxXQUV4QnFFLEdBQWUsZ0JBQWdCUyxpQkFDakMsSUFFQW5NLEVBQWNvQyxpQkFBaUIsU0FBUyxXQUN0Q3NJLEVBQWFWLE1BQ2YsSUFFQTVKLEVBQWlCZ0MsaUJBQWlCLFNBQVMsV0FDekM2SSxHQUFZakIsTUFDZCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXAnLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zYXZlJyxcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zYXZlX2luYWN0aXZlJyxcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxuICBlcnJvckNsYXNzOiAncG9wdXBfX2lucHV0LWVycm9yX3Zpc2libGUnXG59XG5cbmNvbnN0IGJ1dHRvbkFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkJyk7XG5jb25zdCBidXR0b25FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0Jyk7XG5jb25zdCBidXR0b25FZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYXZhdGFyJyk7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6ICfQkNGA0YXRi9C3JyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2Fya2h5ei5qcGcnXG4gIH0sXG4gIHtcbiAgICBuYW1lOiAn0KfQtdC70Y/QsdC40L3RgdC60LDRjyDQvtCx0LvQsNGB0YLRjCcsXG4gICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9jaGVseWFiaW5zay1vYmxhc3QuanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ9CY0LLQsNC90L7QstC+JyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2l2YW5vdm8uanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ9Ca0LDQvNGH0LDRgtC60LAnLFxuICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2FtY2hhdGthLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICfQpdC+0LvQvNC+0LPQvtGA0YHQutC40Lkg0YDQsNC50L7QvScsXG4gICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9raG9sbW9nb3Jza3ktcmF5b24uanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ9CR0LDQudC60LDQuycsXG4gICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9iYWlrYWwuanBnJ1xuICB9XG5dO1xuXG5leHBvcnQge3ZhbGlkYXRpb25Db25maWcsIGJ1dHRvbkFkZENhcmQsIGJ1dHRvbkVkaXRQcm9maWxlLCBpbml0aWFsQ2FyZHMsIGJ1dHRvbkVkaXRBdmF0YXJ9XG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX3N1Ym1pdEJ1dHRvbikge1xuICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfTtcblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGlucHV0RXJyb3IgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVycm9yLnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXQpIHtcbiAgICBjb25zdCBpbnB1dEVycm9yID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFcnJvci50ZXh0Q29udGVudCA9ICcnO1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH1cbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdyZXNldCcsICgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0sIDApO1xuICAgIH0pO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgfSk7XG4gIH07XG59XG4iLCJcbmV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgdGVtcGxhdGVTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCB1c2VySWQsIGhhbmRsZVJlbW92ZUNhcmRDbGljaywgaGFuZGxlRmF2b3JpdGVDbGljaykge1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXM9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fY2FyZE93bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fZmF2b3JpdGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X19mYXZvcml0ZScpO1xuICAgIHRoaXMuX2J1dHRvbkRlbGV0ZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2RlbGV0ZS1idXR0b24nKTtcbiAgICB0aGlzLl9nYWxsZXJ5SW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X19pbWFnZScpO1xuICAgIHRoaXMuX2dhbGxlcnlDaXR5ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fY2l0eScpO1xuICAgIHRoaXMuX2xpa2VzQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2xpa2UnKTtcbiAgICB0aGlzLl9oYW5kbGVSZW1vdmVDYXJkQ2xpY2sgPSBoYW5kbGVSZW1vdmVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRmF2b3JpdGVDbGljayA9IGhhbmRsZUZhdm9yaXRlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcbiAgICAgIC5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2l0ZW0nKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9nYWxsZXJ5Q2l0eS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fZ2FsbGVyeUltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fZ2FsbGVyeUltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX2NhcmRPd25lcklkKSB7XG4gICAgICB0aGlzLl9idXR0b25EZWxldGUucmVtb3ZlKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLl9saWtlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5fdXNlcklkID09PSBpdGVtLl9pZDtcbiAgICB9KSkge1xuICAgICAgdGhpcy5fZmF2b3JpdGVCdXR0b24uY2xhc3NMaXN0LmFkZCgnZ2FsbGVyeV9fZmF2b3JpdGVfYWN0aXZlJyk7XG4gICAgfVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mYXZvcml0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUZhdm9yaXRlQ2xpY2sodGhpcy5fY2FyZElkLCAgdGhpcy5fZmF2b3JpdGVCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdnYWxsZXJ5X19mYXZvcml0ZV9hY3RpdmUnKSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIHRoaXMuX2xpa2VzID0gcmVzLmxpa2VzO1xuICAgICAgICAgIHRoaXMuX2xpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICAgICAgICB0aGlzLl9mYXZvcml0ZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdnYWxsZXJ5X19mYXZvcml0ZV9hY3RpdmUnKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMuX2J1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlUmVtb3ZlQ2FyZENsaWNrKCgpID0+IHRoaXMuX3JlbW92ZUNhcmQoKSwgdGhpcy5fY2FyZElkKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2dhbGxlcnlJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuICAgIH0pXG4gIH07XG5cbiAgX3JlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gfVxuIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKXtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9vcGVuZWQnKSkge1xuICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UnKSkge1xuICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG4iLCJpbXBvcnQge1BvcHVwfSBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbiAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fcGhvdG8tbmFtZScpO1xuICB9XG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gIH1cbn1cbiIsImltcG9ydCB7UG9wdXB9IGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJmb3JtIGlucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uW3R5cGU9J3N1Ym1pdCddXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChldnQsIHZhbHVlcyk7XG4gICAgfSlcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IEFycmF5LmZyb20odGhpcy5faW5wdXRFbGVtZW50cyk7XG4gICAgY29uc3QgaW5wdXRzID0ge307XG4gICAgZWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRzW2VsZW1lbnQubmFtZV0gPSBlbGVtZW50LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dHM7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQ9J9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7dXNlck5hbWUsIHVzZXJJbmZvLCB1c2VyQXZhdGFyfSkge1xuICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xuICAgIHRoaXMuX3VzZXJJbmZvRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckluZm8pO1xuICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyKVxuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJOYW1lOiB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICB1c2VySW5mbzogdGhpcy5fdXNlckluZm9FbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgdXNlcklkOiB0aGlzLl91c2VySWQsXG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8oe25hbWUsIGFib3V0LCBfaWQsIGF2YXRhcn0pIHtcbiAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3VzZXJJbmZvRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIHRoaXMuX3VzZXJJZCA9IF9pZDtcbiAgICB0aGlzLl91c2VyQXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3Ioe2l0ZW1zLCByZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVyRWxlbWVudHMgKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuYWRkSXRlbShpdGVtLCBmYWxzZSk7XG4gICAgfSlcbiAgfVxuXG4gIGFkZEl0ZW0gKGl0ZW0sIHByZXBlbmQpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5fcmVuZGVyZXIoaXRlbSlcbiAgICBwcmVwZW5kID8gdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCkgOiB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Ioe2Jhc2VVcmwsIGhlYWRlcnN9KSB7XG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gIH1cblxuICBnZXRDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzXG4gICAgfSk7XG4gIH1cblxuICBnZXRVc2VyKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcbiAgICB9KTtcbiAgfVxuXG5cbiAgZWRpdFByb2ZpbGUoe25hbWUsIGFib3V0fSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7bmFtZSwgYWJvdXR9KVxuICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZCh7bmFtZSwgbGlua30pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7bmFtZSwgbGlua30pXG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBhZGRMaWtlKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICByZW1vdmVMaWtlKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBjaGFuZ2VBdmF0YXIoYXZhdGFyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7YXZhdGFyfSlcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHtQb3B1cH0gZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2NvbmZpcm1hdGlvbkJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUnKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fY29uZmlybWF0aW9uQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5fY29uZmlybSgpO1xuICAgIH0pXG4gIH1cblxuICBvcGVuKGFjdGlvbikge1xuICAgIHN1cGVyLm9wZW4oKVxuICAgIHRoaXMuX2NvbmZpcm0gPSBhY3Rpb247XG4gIH1cbn1cbiIsImltcG9ydCB7XG4gIHZhbGlkYXRpb25Db25maWcsXG4gIGJ1dHRvbkFkZENhcmQsXG4gIGJ1dHRvbkVkaXRQcm9maWxlLFxuICBidXR0b25FZGl0QXZhdGFyXG59IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cyc7XG5pbXBvcnQge0Zvcm1WYWxpZGF0b3J9IGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQge0NhcmR9IGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgJy4vaW5kZXguY3NzJztcbmltcG9ydCB7UG9wdXBXaXRoSW1hZ2V9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XG5pbXBvcnQge1BvcHVwV2l0aEZvcm19IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCB7VXNlckluZm99IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvXCI7XG5pbXBvcnQge1NlY3Rpb259IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCB7QXBpfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcbmltcG9ydCB7UG9wdXBXaXRoQ29uZmlybWF0aW9ufSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb25cIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYwJyxcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246ICc4YTQwOGZhNS1kNTczLTRhNGItOTk5ZC1lZjJkY2Q4YjYyZWEnLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgfVxufSk7XG5cbmNvbnN0IGhhbmRsZUNhcmRGb3JtU3VibWl0ID0gKGV2dCwgZGF0YSkgPT4ge1xuICBwb3B1cEFkZENhcmQucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpLmFkZENhcmQoe25hbWU6IGRhdGFbJ2lucHV0LXRpdGxlJ10sIGxpbms6IGRhdGFbJ2lucHV0LWxpbmsnXX0pXG4gICAgLnRoZW4oXG4gICAgICAocmVzKSA9PiB7XG4gICAgICAgIGNhcmRzU2VjdGlvbi5hZGRJdGVtKHJlcywgdHJ1ZSk7XG4gICAgICAgIHBvcHVwQWRkQ2FyZC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHBvcHVwQWRkQ2FyZC5yZW5kZXJMb2FkaW5nKCk7XG4gICAgfSk7XG59XG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IChldnQsIGRhdGEpID0+IHtcbiAgcG9wdXBFZGl0UHJvZmlsZS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGkuZWRpdFByb2ZpbGUoe25hbWU6IGRhdGFbJ2lucHV0LW5hbWUnXSwgYWJvdXQ6IGRhdGFbJ2lucHV0LWpvYiddfSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xuICAgICAgcG9wdXBFZGl0UHJvZmlsZS5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwb3B1cEVkaXRQcm9maWxlLnJlbmRlckxvYWRpbmcoKTtcbiAgICB9KTtcbn1cblxuY29uc3QgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCA9IChldnQsIGRhdGEpID0+IHtcbiAgYXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpLmNoYW5nZUF2YXRhcihkYXRhWydhdmF0YXItbGluayddKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XG4gICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoKTtcbiAgICB9KTtcbn1cblxuY29uc3QgaGFuZGxlUmVtb3ZlQ2FyZENsaWNrID0gKGNvbmZpcm1BY3Rpb24sIGlkKSA9PiB7XG4gIGNvbmZpcm1hdGlvblBvcHVwLm9wZW4oKCkgPT4ge1xuICAgIGFwaS5kZWxldGVDYXJkKGlkKS50aGVuKCgpID0+IHtcbiAgICAgIGNvbmZpcm1BY3Rpb24oKTtcbiAgICAgIGNvbmZpcm1hdGlvblBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICB9KVxufVxuXG5jb25zdCBoYW5kbGVGYXZvcml0ZUNsaWNrID0gKGlkLCBpc0xpa2VkKSA9PiB7XG4gIHJldHVybiBpc0xpa2VkID8gYXBpLnJlbW92ZUxpa2UoaWQpIDogYXBpLmFkZExpa2UoaWQpO1xufVxuXG5jb25zdCBjcmVhdGVDYXJkID0gKGNhcmREYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSxcbiAgICAnI2dhbGxlcnktaXRlbS10ZW1wbGF0ZScsXG4gICAgKG5hbWUsIGxpbmspID0+IGltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKSxcbiAgICB1c2VySW5mby5nZXRVc2VySW5mbygpLnVzZXJJZCxcbiAgICBoYW5kbGVSZW1vdmVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlRmF2b3JpdGVDbGljayk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5jb25zdCBwb3B1cEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfYWRkJywgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xuY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0JywgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwX3R5cGVfcGhvdG8nKTtcbmNvbnN0IGNvbmZpcm1hdGlvblBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbignLnBvcHVwX3R5cGVfY29uZmlybScpO1xuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfYXZhdGFyJywgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdClcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgdXNlck5hbWU6ICcucHJvZmlsZV9fbmFtZScsXG4gIHVzZXJJbmZvOiAnLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyxcbiAgdXNlckF2YXRhcjogJy5wcm9maWxlX19pbWFnZSdcbn0pO1xubGV0IGNhcmRzU2VjdGlvbjtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VyKCksIGFwaS5nZXRDYXJkcygpXSlcbiAgLnRoZW4oKFt1c2VyLCBjYXJkc10pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcbiAgICBjYXJkc1NlY3Rpb24gPSBuZXcgU2VjdGlvbih7aXRlbXM6IGNhcmRzLCByZW5kZXJlcjogY3JlYXRlQ2FyZH0sICcuZ2FsbGVyeScpO1xuICAgIGNhcmRzU2VjdGlvbi5yZW5kZXJFbGVtZW50cygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5cbltwb3B1cEFkZENhcmQsIHBvcHVwRWRpdFByb2ZpbGUsIGltYWdlUG9wdXAsIGNvbmZpcm1hdGlvblBvcHVwLCBhdmF0YXJQb3B1cF0uZm9yRWFjaCgoaXRlbSkgPT4ge1xuICBpdGVtLnNldEV2ZW50TGlzdGVuZXJzKClcbn0pO1xuXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IHBvcHVwTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIHBvcHVwTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGlmIChmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtJykpIHtcbiAgICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xuICAgICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtJykuZ2V0QXR0cmlidXRlKCduYW1lJyk7XG4gICAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xuXG5idXR0b25FZGl0UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgcG9wdXBFZGl0UHJvZmlsZS5vcGVuKClcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwb3B1cEVkaXRQcm9maWxlLnNldElucHV0VmFsdWVzKHtcbiAgICAnaW5wdXQtbmFtZSc6IHVzZXJEYXRhLnVzZXJOYW1lLFxuICAgICdpbnB1dC1qb2InOiB1c2VyRGF0YS51c2VySW5mbyxcbiAgfSk7XG4gIGZvcm1WYWxpZGF0b3JzWydwcm9maWxlLWZvcm0nXS5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5idXR0b25BZGRDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBwb3B1cEFkZENhcmQub3BlbigpXG59KTtcblxuYnV0dG9uRWRpdEF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgYXZhdGFyUG9wdXAub3BlbigpXG59KVxuIl0sIm5hbWVzIjpbImJ1dHRvbkFkZENhcmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJidXR0b25FZGl0UHJvZmlsZSIsImJ1dHRvbkVkaXRBdmF0YXIiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2NvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b24iLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJyZW1vdmUiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiZXJyb3JNZXNzYWdlIiwiaWQiLCJ0ZXh0Q29udGVudCIsImlucHV0RXJyb3JDbGFzcyIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldFRpbWVvdXQiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVycyIsIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsInVzZXJJZCIsImhhbmRsZVJlbW92ZUNhcmRDbGljayIsImhhbmRsZUZhdm9yaXRlQ2xpY2siLCJfdXNlcklkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZE93bmVySWQiLCJvd25lciIsIl9pZCIsIl9jYXJkSWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9mYXZvcml0ZUJ1dHRvbiIsIl9idXR0b25EZWxldGUiLCJfZ2FsbGVyeUltYWdlIiwiX2dhbGxlcnlDaXR5IiwiX2xpa2VzQ291bnRlciIsIl9oYW5kbGVSZW1vdmVDYXJkQ2xpY2siLCJfaGFuZGxlRmF2b3JpdGVDbGljayIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJhbHQiLCJzcmMiLCJsZW5ndGgiLCJmaW5kIiwiaXRlbSIsImNvbnRhaW5zIiwidGhlbiIsInJlcyIsInRvZ2dsZSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImV2ZW50IiwiX3JlbW92ZUNhcmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJldnQiLCJrZXkiLCJjbG9zZSIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiUG9wdXBXaXRoSW1hZ2UiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsInByZXZlbnREZWZhdWx0IiwidmFsdWVzIiwiX2dldElucHV0VmFsdWVzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRFbGVtZW50cyIsIl9zdWJtaXRCdXR0b25UZXh0IiwiZWxlbWVudHMiLCJpbnB1dHMiLCJlbGVtZW50IiwidmFsdWUiLCJyZXNldCIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiVXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJJbmZvIiwidXNlckF2YXRhciIsIl91c2VyTmFtZUVsZW1lbnQiLCJfdXNlckluZm9FbGVtZW50IiwiX3VzZXJBdmF0YXJFbGVtZW50IiwiYWJvdXQiLCJhdmF0YXIiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJwcmVwZW5kIiwiYXBwZW5kIiwiQXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwidXJsIiwib3B0aW9ucyIsImZldGNoIiwiX2NoZWNrUmVzcG9uc2UiLCJfcmVxdWVzdCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiX2NvbmZpcm1hdGlvbkJ1dHRvbiIsIl9jb25maXJtIiwiYWN0aW9uIiwiY2FyZHNTZWN0aW9uIiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsImNvbmZpcm1BY3Rpb24iLCJjb25maXJtYXRpb25Qb3B1cCIsIm9wZW4iLCJkZWxldGVDYXJkIiwiaXNMaWtlZCIsInJlbW92ZUxpa2UiLCJhZGRMaWtlIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwiaW1hZ2VQb3B1cCIsImdldFVzZXJJbmZvIiwiZ2VuZXJhdGVDYXJkIiwicG9wdXBBZGRDYXJkIiwicmVuZGVyTG9hZGluZyIsImFkZENhcmQiLCJmaW5hbGx5IiwicG9wdXBFZGl0UHJvZmlsZSIsImVkaXRQcm9maWxlIiwic2V0VXNlckluZm8iLCJhdmF0YXJQb3B1cCIsImNoYW5nZUF2YXRhciIsImFsbCIsImdldFVzZXIiLCJnZXRDYXJkcyIsInVzZXIiLCJjYXJkcyIsInJlbmRlckVsZW1lbnRzIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1TZWxlY3RvciIsImVycm9yQ2xhc3MiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJ1c2VyRGF0YSIsInNldElucHV0VmFsdWVzIiwicmVzZXRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==